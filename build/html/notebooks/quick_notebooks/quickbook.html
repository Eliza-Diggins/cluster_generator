
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quickstart Guide: The Basics &#8212; cluster_generator  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fd506691" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=ccbe24c1"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/quick_notebooks/quickbook';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">cluster_generator  documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Getting_Started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../gravity.html">
                        Gravity Theories
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../models.html">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../collections.html">
                        Collections
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples.html">
                        Examples
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api.html">
                        API
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Getting_Started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../gravity.html">
                        Gravity Theories
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../models.html">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../collections.html">
                        Collections
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples.html">
                        Examples
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api.html">
                        API
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Quickstart Guide: The Basics</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="Quickstart-Guide:-The-Basics">
<h1>Quickstart Guide: The Basics<a class="headerlink" href="#Quickstart-Guide:-The-Basics" title="Permalink to this heading">#</a></h1>
<hr class="docutils" />
<p>Okay, I‚Äôve installed <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code> and I want to start making clusters for my simulation project‚Ä¶ How do I start? This guide will show you the ropes as far as using <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code> to build you galaxy cluster models!</p>
<section id="Contents">
<h2>Contents<a class="headerlink" href="#Contents" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#Building-The-Foundation"><span class="std std-ref">Building the Foundation: Profiles</span></a></p></li>
<li><p><a class="reference internal" href="#Raising-The-Frame"><span class="std std-ref">Raising the Frame: Cluster Models</span></a></p></li>
<li><p><a class="reference internal" href="#Finishing-The-House"><span class="std std-ref">Finishing the House: Cluster ICs</span></a></p></li>
</ul>
</section>
<section id="Building-The-Foundation">
<h2>Building The Foundation<a class="headerlink" href="#Building-The-Foundation" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="alert alert-block alert-info"><p><p>üí° Big Ideas:</p>
</p><p>Profiles are the underpinning of all of the systems you can build in cluster_generator. Before you can build a galaxy cluster, you have to select the profiles you‚Äôre going to provide in order to make the system.</p>
</div><p>There are a variety of radial profiles available in cluster_generator, which you can find on the <a class="reference external" href="https://eliza-diggins.github.io/cluster_generator/build/html/radial_profiles.html#radial-profiles">Radial Profiles page</a> of the documentation. Each of these <code class="docutils literal notranslate"><span class="pre">RadialProfile</span></code> objects is really just a fancy wrapper for a simple function. Let‚Äôs see an example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- Imports -- #</span>
<span class="kn">import</span> <span class="nn">cluster_generator</span> <span class="k">as</span> <span class="nn">cg</span>

<span class="c1"># -- building the profile -- #</span>
<span class="n">example_profile</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">radial_profiles</span><span class="o">.</span><span class="n">hernquist_density_profile</span><span class="p">(</span><span class="mf">1e10</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span> <span class="c1"># Create a Hernquist Profile</span>

<span class="nb">print</span><span class="p">(</span><span class="n">example_profile</span><span class="p">,</span> <span class="n">example_profile</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RadialProfile; type=hernquist_density_profile. 74.60387957432596
</pre></div></div>
</div>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">example_profile</span></code> is its own type, but is also callable? The basic construction of <code class="docutils literal notranslate"><span class="pre">RadialProfile</span></code> objects is as a wrapper for simple lambda functions. In fact, you can make your own radial profiles by simply supplying a lambda function to the <code class="docutils literal notranslate"><span class="pre">RadialProfile</span></code> class.</p>
<p>There really isn‚Äôt a whole lot to the <code class="docutils literal notranslate"><span class="pre">RadialProfiles</span></code>, but they‚Äôre really important. The important things to remember are as follows:</p>
<div class="alert alert-block alert-warning"><p><p>üí° Things To Remember:</p>
</p><ul><li><p>RadialProfiles are not unit-ed. This means you need to follow standard conventions for units (Myr, kpc, Solar Masses).</p>
</li><li><p>RadialProfiles can be saved to a binary format (using the .to_binary method).</p>
</li><li><p>RadialProfiles can have cores added or be truncated if needed (.cutoff and .add_core respectively).</p>
</li><li><p>RadialProfiles can be plotted using the .plot method.</p>
</li></ul></div><p>We won‚Äôt go into to much detail about <code class="docutils literal notranslate"><span class="pre">RadialProfile</span></code> objects here, if you‚Äôre interested in knowing more, see the <a class="reference external" href="http://localhost:63342/cluster_generator/docs/build/html/_as_gen/radial_profiles.html">api documentation</a>. For now, let‚Äôs start by defining the basic profiles we‚Äôre going to use to build our cluster:</p>
<div class="alert alert-block alert-warning"><p><p>üí° Alert:</p>
</p><p>You don‚Äôt need the colossus package to use cluster_generator; however, we will mention here that colossus has many utilities that are useful for generating well chosen radial profiles for your clusters.</p>
</div><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- building the cluster profiles -- #</span>
<span class="kn">from</span> <span class="nn">colossus.halo</span> <span class="kn">import</span> <span class="n">concentration</span>
<span class="kn">from</span> <span class="nn">colossus.cosmology</span> <span class="kn">import</span> <span class="n">cosmology</span>
<span class="kn">from</span> <span class="nn">yt.utilities.cosmology</span> <span class="kn">import</span> <span class="n">Cosmology</span>

<span class="c1"># -- Setting Cosmology Parameters (OPTIONAL) -- #</span>
<span class="n">ccosmo</span> <span class="o">=</span> <span class="n">cosmology</span><span class="o">.</span><span class="n">setCosmology</span><span class="p">(</span><span class="s2">&quot;planck18&quot;</span><span class="p">)</span>
<span class="n">cosmo</span> <span class="o">=</span> <span class="n">Cosmology</span><span class="p">(</span>
    <span class="n">hubble_constant</span><span class="o">=</span><span class="n">ccosmo</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">omega_matter</span><span class="o">=</span><span class="n">ccosmo</span><span class="o">.</span><span class="n">Om0</span><span class="p">,</span> <span class="n">omega_lambda</span><span class="o">=</span><span class="n">ccosmo</span><span class="o">.</span><span class="n">Ode0</span>
<span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">0.546</span> <span class="c1"># --&gt; set the redshift</span>

<span class="c1"># -- Building the Cluster -- #</span>

<span class="n">m200</span> <span class="o">=</span> <span class="mf">1.1e15</span><span class="o">*</span><span class="mf">1.23</span> <span class="c1"># --&gt; Set the mass</span>

<span class="n">conc</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">modelDiemer19</span><span class="p">(</span><span class="n">m200</span><span class="o">/</span><span class="n">ccosmo</span><span class="o">.</span><span class="n">h</span><span class="p">,</span><span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Uses the concentration - mass relation to find the right concentration parameter</span>
<span class="n">r200</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">find_overdensity_radius</span><span class="p">(</span><span class="n">m200</span><span class="p">,</span><span class="mf">200.0</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">cosmo</span><span class="o">=</span><span class="n">cosmo</span><span class="p">)</span>

<span class="n">rs</span> <span class="o">=</span> <span class="n">r200</span><span class="o">/</span><span class="n">conc</span>
<span class="n">rt</span> <span class="o">=</span> <span class="n">r200</span><span class="o">*</span><span class="mi">2</span>
<span class="c1"># Building the profiles #</span>
<span class="n">Mt</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">tnfw_mass_profile</span><span class="p">(</span><span class="n">cg</span><span class="o">.</span><span class="n">nfw_scale_density</span><span class="p">(</span><span class="n">conc</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">),</span> <span class="n">rs</span><span class="p">,</span> <span class="n">rt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let‚Äôs take a look at what we just made:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">Mt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dynamical Mass / [$\mathrm{M_{\odot}}$]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_quick_notebooks_quickbook_5_0.png" src="../../_images/notebooks_quick_notebooks_quickbook_5_0.png" />
</div>
</div>
<p>For the next session, we are also going to need a gas-mass profile, so let‚Äôs see how to build that really quick!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- Constructing the density profiles for later -- #</span>
<span class="n">f_g</span> <span class="o">=</span> <span class="mf">0.115</span> <span class="c1"># --&gt; this is the gas fraction</span>

<span class="c1"># -- Build the total density -- #</span>
<span class="n">rhot</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">tnfw_density_profile</span><span class="p">(</span><span class="n">cg</span><span class="o">.</span><span class="n">nfw_scale_density</span><span class="p">(</span><span class="n">conc</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">),</span> <span class="n">rs</span><span class="p">,</span> <span class="n">rt</span><span class="p">)</span> <span class="c1"># --&gt; converting the mass profile above to a density profile.</span>

<span class="c1"># -- Building the gas density -- #</span>
<span class="n">r2500</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">find_radius_mass</span><span class="p">(</span><span class="n">Mt</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">delta</span><span class="o">=</span><span class="mf">2500.0</span><span class="p">,</span><span class="n">cosmo</span><span class="o">=</span><span class="n">cosmo</span><span class="p">)</span> <span class="c1"># --&gt; Find r2500 for the total cluster.</span>
<span class="n">rhog</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">vikhlinin_density_profile</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">r2500</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">r200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># --&gt; Use r2500 and r200 to build a profile.</span>
<span class="n">rhog</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">rescale_profile_by_mass</span><span class="p">(</span><span class="n">rhog</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">*</span> <span class="n">m200</span><span class="p">,</span> <span class="n">r200</span><span class="p">)</span> <span class="c1"># --&gt; Rescale so that it has the right gas fraction.</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rhot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1e1</span><span class="p">,</span><span class="mf">1e4</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">rhog</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1e1</span><span class="p">,</span><span class="mf">1e4</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density / $[\mathrm{M_{\odot} \; kpc^{-3}}]$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_quick_notebooks_quickbook_7_0.png" src="../../_images/notebooks_quick_notebooks_quickbook_7_0.png" />
</div>
</div>
</section>
<section id="Raising-The-Frame">
<h2>Raising The Frame<a class="headerlink" href="#Raising-The-Frame" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="alert alert-block alert-info"><p><p>üí° Big Ideas:</p>
</p><p>While RadialProfiles represent the data from which we want to construct a self-consistent system, the ClusterModel class represents the realization of a fully constructed galaxy cluster.</p>
</div><p>So far, we‚Äôve seen how to make the RadialProfile objects that we want to use to build galaxy clusters. Now, we‚Äôre ready to pull it all together. In cluster_generator, the <a class="reference external" href="https://eliza-diggins.github.io/cluster_generator/build/html/models.html">ClusterModel</a> class is the realization of a complete galaxy cluster. All of these instances are predicated on hydrostatic equilibrium. There are a variety of ways to generate these objects directly from profiles; however, here we are going to use only
the dynamical density and the gas density to produce our cluster.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turning off spinners because Jupyter notebooks don&#39;t render them properly.</span>
<span class="kn">from</span> <span class="nn">cluster_generator.utils</span> <span class="kn">import</span> <span class="n">cgparams</span>
<span class="n">cgparams</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">][</span><span class="s2">&quot;spinners&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">ClusterModel</span><span class="o">.</span><span class="n">from_dens_and_tden</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">15000.0</span><span class="p">,</span> <span class="n">rhog</span><span class="p">,</span> <span class="n">rhot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-09-10 09:57:30,876 Computing the profiles from density and total density. Gravity=Newtonian
cluster_generator : [INFO     ] 2023-09-10 09:57:30,878 Integrating total mass profile.
cluster_generator : [INFO     ] 2023-09-10 09:57:31,101 ClusterModel [ClusterModel object; gravity=Newtonian] has no virialization method. Setting to default = eddington
cluster_generator : [INFO     ] 2023-09-10 09:57:31,102 Computing gravitational potential of ClusterModel object; gravity=Newtonian. gravity=Newtonian.
cluster_generator : [INFO     ] 2023-09-10 09:57:32,215 Integrating pressure profile.
                [from_scratch]: Sun Sep 10 09:57:38 2023 Checking for missing mass / density fields...[DONE]
                [from_scratch]: Sun Sep 10 09:57:38 2023 Determining the halo component...[DONE]
                [from_scratch]: Sun Sep 10 09:57:38 2023 Computing additional fields...[DONE]
                [from_scratch]: Sun Sep 10 09:57:38 2023 Initializing the ClusterModel...
</pre></div></div>
</div>
<p>Okay, so a lot of things appear to have happened! For a complete picture of what all of these logging calls mean, see the <a class="reference external" href="https://eliza-diggins.github.io/cluster_generator/build/html/notebooks/api_guides/1.html">data structures guide</a>. The important parts of this from the user‚Äôs perspective are as follows:</p>
<ul class="simple">
<li></li>
<li></li>
</ul>
<p>For the most part, general usage won‚Äôt require the user paying much attention to these two options. Typically, <code class="docutils literal notranslate"><span class="pre">eddington</span></code> is the best option for virialization and <code class="docutils literal notranslate"><span class="pre">Newtonian</span></code> is the standard gravity. A more comprehensive account of the different gravities and virialization methods can be found in other, more complex, guides.</p>
<p>Let‚Äôs look at what‚Äôs actually here:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ClusterModel object; gravity=Newtonian, fields=[&#39;radius&#39;, &#39;density&#39;, &#39;total_density&#39;, &#39;total_mass&#39;, &#39;gas_mass&#39;, &#39;stellar_density&#39;, &#39;gravitational_potential&#39;, &#39;gravitational_field&#39;, &#39;pressure&#39;, &#39;temperature&#39;, &#39;dark_matter_density&#39;, &#39;dark_matter_mass&#39;, &#39;gas_fraction&#39;, &#39;electron_number_density&#39;, &#39;entropy&#39;]
</pre></div></div>
</div>
<p>So when we print the ClusterModel object, we see that it‚Äôs using Newtonian gravity and has a long list of fields.</p>
<div class="alert alert-block alert-success"><p><p>üí° Fields:</p>
</p><p>Many of the data structures in cluster_generator, and in similar projects like yt are focused around so called fields. Each field is essentially an array containing the pertinent data for that particular quantity. In this case, each field in a ClusterModel instances is just a 1D array containing the radial profile for that quantity. The big takeaway is that when a ClusterModel is generated, the behind-the-scenes machinery will use the profiles the user provided to build all of the other useful /
interesting data.</p>
</div><p>Let‚Äôs take a look at some of the features we can take advantage of with <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> instances. The first thing to know is that we can plot any of the fields we‚Äôre interested in:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature / [$\mathrm</span><span class="si">{keV}</span><span class="s2">$]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_quick_notebooks_quickbook_13_0.png" src="../../_images/notebooks_quick_notebooks_quickbook_13_0.png" />
</div>
</div>
<p>There are two other extremely useful things you can get from the ClusterModel instance: the physicality, and the HSE quality. Let‚Äôs start by looking at HSE. Every galaxy cluster is assumed to follow HSE, and therefore it is a good check on the code to make sure that your cluster is actually equilibrated properly. To check this,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">check_hse</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-09-10 09:57:38,545 The maximum relative deviation of this profile from hydrostatic equilibrium is 0.00110331
</pre></div></div>
</div>
<p>So we see that the cluster is in hydrostatic equilibrium to 1 part in about 1000.</p>
<div class="alert alert-block alert-info"><p><p>‚úÖ Common Sense Test:</p>
</p><p>This is a really easy check to always build into your initialization system. Clusters should always be in HSE unless your intention is specifically to prevent them from being in HSE.</p>
</div><p>We can also check that the cluster is physically consistent (i.e. no negative densities, negative temperatures, etc.). To do so, we use the following</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">is_physical</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model is physical? </span><span class="si">{</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
‚úî cluster_generator : [INFO     ] Sun Sep 10 09:57:38 2023 Checking physicality ‚†ô luster_generator : [INFO     ] Sun Sep 10 09:57:38 2023 Checking physicality o ClusterModel object; gravity=Newtonian is physical.

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The model is physical? True
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="alert alert-block alert-info"><p><p>‚ùì Why Physicality?</p>
</p><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>While this cluster is intrinsically self-consistent, some clusters may be generated with profiles which are not actually self consistent over their domain. This can lead to non-physical behaviors in some of the derived fields.
</pre></div>
</div>
</div></section>
<section id="Finishing-The-House">
<h2>Finishing The House<a class="headerlink" href="#Finishing-The-House" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Okay, we‚Äôve seen how to make self-consistent galaxy clusters using cluster_generator, we‚Äôre ready to pull things all together. In this section, we‚Äôre going to see the <code class="docutils literal notranslate"><span class="pre">ClusterICs</span></code> class, which can contain one or more cluster models and is the class which joins the code-specific frontends with the base code of the cluster_generator library. Making one is simple:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- Saving the model to file -- #</span>
<span class="n">model</span><span class="o">.</span><span class="n">write_model_to_h5</span><span class="p">(</span><span class="s2">&quot;basic_model.h5&quot;</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># -- Building the IC -- #</span>
<span class="n">ic</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">ClusterICs</span><span class="p">(</span><span class="s2">&quot;ic_example&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="s2">&quot;basic_model.h5&quot;</span><span class="p">],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],{</span><span class="s2">&quot;dm&quot;</span><span class="p">:</span><span class="mi">100_000</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-09-10 09:57:38,695 Loading ClusterModel instance from basic_model.h5.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;cluster_generator.ics.ClusterICs object at 0x7f90bef59fd0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>Okay, so we‚Äôve successfully built the initial conditions object. It‚Äôs worth noting that these objects can accomodate an arbitrary number of clusters at once, which allows you to generate merger scenarios. In this guide, we‚Äôre really only interested in 2 functionalities of the initial conditions object. The first is that it can be converted into a yt dataset using the .create_dataset method. The second is that we can use these objects to interact directly with the front-end. For example, if we
want to create RAMSES style initial conditions, we need only run</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cluster_generator.codes</span> <span class="kn">import</span> <span class="n">setup_ramses_ics</span>
<span class="n">setup_ramses_ics</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-09-10 09:57:38,729 Loading ClusterModel instance from basic_model.h5.
cluster_generator : [INFO     ] 2023-09-10 09:57:38,755 Loading ClusterModel instance from basic_model.h5.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "23fc2f6e50ca4324995fa132bac1282a"}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-09-10 09:57:39,915 We will be assigning 100000 dark_matter particles.
cluster_generator : [INFO     ] 2023-09-10 09:57:39,916 Compute 100000 particle positions.
cluster_generator : [INFO     ] 2023-09-10 09:57:39,944 Computing dark_matter velocities using eddington method.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "b331781c5e294d7e830c02cc79c9a95d"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-09-10 09:57:42,778 Simulation setups saved to Merger_Config.txt.

</pre></div></div>
</div>
<p>And there you have it; your first initial conditions in cluster_generator!</p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Building-The-Foundation">Building The Foundation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Raising-The-Frame">Raising The Frame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Finishing-The-House">Finishing The House</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/notebooks/quick_notebooks/quickbook.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      ¬© Copyright 2020, John ZuHone and Eliza DIggins.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>