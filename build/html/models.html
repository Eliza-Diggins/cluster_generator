
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Cluster Models &#8212; cluster_generator  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=c5ced968eda925caa686" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=c5ced968eda925caa686" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=c5ced968eda925caa686"></script>

    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/hoverxref.js"></script>
    <script src="_static/js/tooltipster.bundle.min.js"></script>
    <script src="_static/js/micromodal.min.js"></script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'models';</script>
    <link rel="icon" href="_static/cluster_generator_logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Simulation Software" href="codes.html" />
    <link rel="prev" title="Examples" href="examples.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/cluster_generator_logo.png" class="logo__image only-light" alt="cluster_generator  documentation - Home"/>
    <script>document.write(`<img src="_static/cluster_generator_logo.png" class="logo__image only-dark" alt="cluster_generator  documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="codes.html">
                        Simulation Software
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="codes.html">
                        Simulation Software
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Cluster Models</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="cluster-models">
<span id="id1"></span><h1><a class="toc-backref" href="#id2" role="doc-backlink">Cluster Models</a><a class="headerlink" href="#cluster-models" title="Link to this heading">#</a></h1>
<p>The <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> class is one of the core structures available in <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code>. These objects hold all of
the data related to a single cluster being modeled. The user can use a <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> object to generate particle distributions,
enforce hydrostatic equilibrium, virialize halos, and generate initial conditions. Furthermore, the user can generate
<a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> objects using a variety of pre-built protocols using <a class="reference internal" href="_as_gen/radial_profiles.RadialProfile.html#radial_profiles.RadialProfile" title="radial_profiles.RadialProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">radial_profiles.RadialProfile</span></code></a> objects to provide necessary fields of data.</p>
<hr style="color:black"><nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#cluster-models" id="id2">Cluster Models</a></p>
<ul>
<li><p><a class="reference internal" href="#cluster-models-mathematical-overview" id="id3">Cluster Models: Mathematical Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#the-intracluster-medium-icm" id="id4">The Intracluster Medium (ICM)</a></p></li>
<li><p><a class="reference internal" href="#gravity" id="id5">Gravity</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#generating-a-model-clustermodel-using-radial-profiles" id="id6">Generating a <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> Using Radial Profiles</a></p></li>
<li><p><a class="reference internal" href="#checking-the-hydrostatic-equilibrium" id="id7">Checking the Hydrostatic Equilibrium</a></p></li>
<li><p><a class="reference internal" href="#setting-a-magnetic-field-strength-profile" id="id8">Setting a Magnetic Field Strength Profile</a></p></li>
<li><p><a class="reference internal" href="#adding-other-fields" id="id9">Adding Other Fields</a></p></li>
<li><p><a class="reference internal" href="#reading-and-writing-model-clustermodel-objects-to-and-from-disk" id="id10">Reading and Writing <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> Objects to and from Disk</a></p></li>
<li><p><a class="reference internal" href="#non-physical-profiles" id="id11">Non-Physical Profiles</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr style="height:10px;background-color:black"><section id="cluster-models-mathematical-overview">
<span id="math-overview-models"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Cluster Models: Mathematical Overview</a><a class="headerlink" href="#cluster-models-mathematical-overview" title="Link to this heading">#</a></h2>
<div class="admonition-reader-suggestion admonition">
<p class="admonition-title">Reader Suggestion</p>
<p>To learn more about the various gravity theories discussed here, see the <span class="xref std std-ref">gravity</span> page.</p>
</div>
<section id="the-intracluster-medium-icm">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">The Intracluster Medium (ICM)</a><a class="headerlink" href="#the-intracluster-medium-icm" title="Link to this heading">#</a></h3>
<p>Assuming the intracluster medium of galaxy clusters can be modeled as an
ideal fluid, the momentum density <span class="math notranslate nohighlight">\(\rho{\bf v}\)</span> of the
gas obeys the Euler momentum equation (here written in conservative form
and ignoring magnetic fields, viscosity, etc.):</p>
<div class="math notranslate nohighlight">
\[\frac{\partial({\rho_g{\bf v}})}{\partial{t}} + \nabla \cdot (\rho_g{\bf v}{\bf v})
= -\nabla{P} + \rho_g{\bf g}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_g\)</span> is the gas density, <span class="math notranslate nohighlight">\({\bf v}\)</span> is the gas velocity,
<span class="math notranslate nohighlight">\(P\)</span> is the gas pressure, and <span class="math notranslate nohighlight">\({\bf g}\)</span> is the gravitational
acceleration. The assumption of hydrostatic equilibrium implies that
<span class="math notranslate nohighlight">\({\bf v} = 0\)</span> and that all time derivatives are zero, giving:</p>
<div class="math notranslate nohighlight">
\[\nabla{P} = \rho_g{\bf g}\]</div>
<p>We therefore define the “hydrostatic vector”, <span class="math notranslate nohighlight">\(\Gamma\)</span> of the system to be</p>
<div class="math notranslate nohighlight">
\[\Gamma = -\frac{\nabla P}{\rho_g} = \nabla \Phi.\]</div>
<p>In the context of galaxy clusters, we may typically assume an ideal gas behavior for the ICM, and therefore,</p>
<div class="math notranslate nohighlight">
\[\Gamma = -\frac{\nabla P}{\rho_g} = \frac{-k_b T}{m_p \eta} \left[\frac{d\ln(\rho_g)}{dr} + \frac{d\ln(T)}{dr} \right].\]</div>
<p>As such, we recognize that from <span class="math notranslate nohighlight">\(\rho_g\)</span> and <span class="math notranslate nohighlight">\(T\)</span>, we can generally obtain the acceleration and therefore the dynamical mass
of the system. Because the dynamical mass need not be equivalent to the gasseous mass, it follows that finding the dynamical mass will also
yield the halo mass of the system.</p>
<p>It is worth noting throughout the remainder of this document that for <span class="math notranslate nohighlight">\(r\to \infty\)</span>, if <span class="math notranslate nohighlight">\(\rho \sim r^\alpha\)</span> and <span class="math notranslate nohighlight">\(T\sim r^\beta\)</span>,
then</p>
<div class="math notranslate nohighlight">
\[\Gamma \sim r^{\beta-1}.\]</div>
<p>This point becomes important as we begin discussing the interaction between the gas dynamics above and the potential of the system.</p>
</section>
<section id="gravity">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Gravity</a><a class="headerlink" href="#gravity" title="Link to this heading">#</a></h3>
<p>In the preceding section, we described the basic mathematics of hydrostatic equilibrium; however, to find the dynamical mass and other related quantities,
an expression for <span class="math notranslate nohighlight">\(\Gamma\)</span> must be obtained independently. In each gravitational theory implemented in CG, the dynamical field may be determined in terms of
<span class="math notranslate nohighlight">\(\Gamma\)</span> and can then be used to construct the correct mass profiles. In the window below, we’ve included 3 archetypal examples:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
Newtonian</label><div class="sd-tab-content docutils">
<p>In Newtonian gravity, the dynamical mass equation derived from the Poisson equation is</p>
<div class="math notranslate nohighlight">
\[M_{\mathrm{dyn}}(&lt;r) = \frac{r^2}{G}\Gamma = \frac{-r^2 k_b T}{G m_p \eta} \left[\frac{d\ln(\rho_g)}{dr} + \frac{d\ln(T)}{dr} \right].\]</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
AQUAL</label><div class="sd-tab-content docutils">
<p>In the AQUAL flavor of MOND, the dynamical mass is different from the Newtonian case by a factor of <span class="math notranslate nohighlight">\(\mu(a)\)</span>.</p>
<div class="math notranslate nohighlight">
\[M_{\mathrm{dyn}} = \frac{r^2}{G}\mu\left(\frac{| \Gamma |}{a_0}\right)\Gamma.\]</div>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-2">
QUMOND</label><div class="sd-tab-content docutils">
<p>In the QUMOND flavor of MOND, the equations cannot be solved independently and therefore numerical methods are required to solve the
implicit equation</p>
<div class="math notranslate nohighlight">
\[\nu\left(\frac{|\nabla \Psi |}{a_0}\right)\nabla \Psi = \Gamma,\;\;\nabla \Psi = \frac{GM_{\mathrm{dyn}}}{r^2}\]</div>
</div>
</div>
<p>Each of these theories has a different asymptotic behavior in terms of the temperature. Therefore, the required temperature behavior at large
radii is constrained by the following table. This should be considered when choosing a model.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Gravity Type</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\Gamma\)</span> and <span class="math notranslate nohighlight">\(\Phi\)</span> relationship</p></th>
<th class="head"><p>Mass Stability Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Newtonian</p></td>
<td><p><span class="math notranslate nohighlight">\(\Gamma = \nabla \Phi = GM_{\mathrm{dyn}}(&lt;r)/r^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T\sim r^{-1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>AQUAL</p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\left(\frac{|\Gamma|}{a_0}\right)\Gamma = GM_{\mathrm{dyn}}(&lt;r)/r^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T\sim r^{0}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>QUMOND</p></td>
<td><p><span class="math notranslate nohighlight">\(\Gamma = \nu\left(\frac{|\nabla \Psi|}{a_0}\right) \nabla \Psi\)</span> where
<span class="math notranslate nohighlight">\(\nabla \Psi = GM_{\mathrm{dyn}}(&lt;r)/r^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T\sim r^{0}\)</span></p></td>
</tr>
</tbody>
</table>
<hr style="height:10px;background-color:black"></section>
</section>
<section id="generating-a-model-clustermodel-using-radial-profiles">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Generating a <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> Using Radial Profiles</a><a class="headerlink" href="#generating-a-model-clustermodel-using-radial-profiles" title="Link to this heading">#</a></h2>
<p>Based on the mathematics above, there are a variety of ways to produce <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> objects. Most of the common approaches
that see use in practice are built into the <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code> package; however, the <a class="reference internal" href="_as_gen/model.ClusterModel.from_arrays.html#model.ClusterModel.from_arrays" title="model.ClusterModel.from_arrays"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_arrays()</span></code></a> class method can
be used to generate a <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> object manually. The available generation approaches are listed as follows:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>From <span class="math notranslate nohighlight">\(\rho_g\)</span>
and <span class="math notranslate nohighlight">\(\rho_{\mathrm{dyn}}\)</span></p></td>
<td><p><a class="reference internal" href="_as_gen/model.ClusterModel.from_dens_and_tden.html#model.ClusterModel.from_dens_and_tden" title="model.ClusterModel.from_dens_and_tden"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dens_and_tden()</span></code></a></p></td>
<td><p>Generates the galaxy cluster from the gas and dynamical density
profiles. Computes temperature / grav. field.</p></td>
</tr>
<tr class="row-odd"><td><p>From <span class="math notranslate nohighlight">\(\rho_g\)</span>
and <span class="math notranslate nohighlight">\(T_g\)</span></p></td>
<td><p><a class="reference internal" href="_as_gen/model.ClusterModel.from_dens_and_temp.html#model.ClusterModel.from_dens_and_temp" title="model.ClusterModel.from_dens_and_temp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dens_and_temp()</span></code></a></p></td>
<td><p>Generates the galaxy cluster from the gas density and temperature
profiles. Computes total mass, dm, stellar etc.</p></td>
</tr>
<tr class="row-even"><td><p>From <span class="math notranslate nohighlight">\(\rho_g\)</span>
and <span class="math notranslate nohighlight">\(\rho_{\mathrm{dyn}}\)</span></p></td>
<td><p><a class="reference internal" href="_as_gen/model.ClusterModel.from_dens_and_entr.html#model.ClusterModel.from_dens_and_entr" title="model.ClusterModel.from_dens_and_entr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dens_and_entr()</span></code></a></p></td>
<td><p>Generates the galaxy cluster from the gas density and entropy
profiles. Computes total mass, dm, stellar etc.</p></td>
</tr>
</tbody>
</table>
<p>The user may generate a <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> from the <a class="reference internal" href="_as_gen/model.ClusterModel.from_dens_and_temp.html#model.ClusterModel.from_dens_and_temp" title="model.ClusterModel.from_dens_and_temp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">model.ClusterModel.from_dens_and_temp()</span></code></a> method, which requires <a class="reference internal" href="_as_gen/radial_profiles.RadialProfile.html#radial_profiles.RadialProfile" title="radial_profiles.RadialProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">radial_profiles.RadialProfile</span></code></a> objects
for the temperature and the gas density. Using the condition of hydrostatic equilibrium, the potential, pressure, dynamical mass, and other
necessary fields are automatically computed based on the chosen gravity theory.</p>
<p>The pressure <span class="math notranslate nohighlight">\(P(r)\)</span> is provided via the ideal gas law:</p>
<div class="math notranslate nohighlight">
\[P(r) = \frac{\rho_g(r) k_b T(r)}{m_p \eta},\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta\)</span> is the mean-molecular mass (generally 0.6 for galaxy clusters).</p>
<p>Once the pressure is determined, Euler’s Equations can be used for an incompressible fluid, yielding</p>
<div class="math notranslate nohighlight">
\[\Gamma = \frac{-\nabla P(r)}{\rho_g} = \nabla \Phi\]</div>
<p>Once the potential has been determined, the corresponding gravity theory is applied to determine the dynamical mass of the system and
by extension determine the necessary halo component.</p>
<div class="math notranslate nohighlight">
\[M_{dm} = M_{\mathrm{dyn}} - M_{\mathrm{bary}}.\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Provided</p></th>
<th class="head"><p>Computed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T_g\)</span>
<span class="math notranslate nohighlight">\(\rho_{g}\)</span>
<span class="math notranslate nohighlight">\(\rho_{\star}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rho_{dm}, M_{dm}, M_{dyn}\)</span>
<span class="math notranslate nohighlight">\(S, \Phi, \nabla \Phi, P\)</span></p></td>
</tr>
</tbody>
</table>
<p>In the case where the dynamical density is already known, the halo mass function is trivially obtained from</p>
<div class="math notranslate nohighlight">
\[\rho_{\mathrm{halo}} = \rho_{\mathrm{dyn}} - \rho_{\mathrm{bary}},\]</div>
<p>where the baryonic component may contain a stellar distribution if the user supplies one. The difficult in this case
is to efficiently determine the temperature profile which yields HSE. Recalling that</p>
<div class="math notranslate nohighlight">
\[\Gamma = -\frac{\nabla P}{\rho_g} = \frac{-k_b T}{m_p \eta} \left[\frac{d\ln(\rho_g)}{dr} + \frac{d\ln(T)}{dr} \right].\]</div>
<p>The differential equation may be inverted, yielding</p>
<div class="math notranslate nohighlight">
\[T(r) = \frac{-m_p \eta}{k_b \rho_g} \int_{r_0}^r \rho_g(r') \nabla \Phi(r') dr' + \frac{\rho_g(r_0)}{\rho_g(r)}T(r_0).\]</div>
<p>The most efficient approach here is to take <span class="math notranslate nohighlight">\(r_0 = \infty\)</span>, in which case,</p>
<div class="math notranslate nohighlight">
\[T(r) = \frac{m_p \eta}{k_b \rho_g} \int_{r}^\infty \rho_g(r') \nabla \Phi(r') dr'.\]</div>
<p>From this, the temperature profile is obtained.</p>
<p>Users may also generate a <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> object from an entropy profile instead of the corresponding temperature profile.
There is a 1-to-1 correspondence between entropy and temperature given that the gas density is fixed, therefore, the procedure
follows exactly from the previous section; however, the entropy is converted first to a temperature profile using the widely accepted formula</p>
<div class="math notranslate nohighlight">
\[S(r) = k_b T_g(r)n_e(r)^{-2/3}.\]</div>
<p>Not all of the <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> objects are generated with a gas density profile. If one wants to produce a gas-less model,
the <a class="reference internal" href="_as_gen/model.ClusterModel.no_gas.html#model.ClusterModel.no_gas" title="model.ClusterModel.no_gas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">model.ClusterModel.no_gas()</span></code></a> method is available. Users must provide a dynamical density profile, and are optionally allowed
to provide a stellar component. See the API reference for syntactical information.</p>
</section>
<section id="checking-the-hydrostatic-equilibrium">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Checking the Hydrostatic Equilibrium</a><a class="headerlink" href="#checking-the-hydrostatic-equilibrium" title="Link to this heading">#</a></h2>
<p>In the vast majority of cases, the aim of the <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> object is to produce a model which is in hydrostatic equilibrium. To check how successful the algorithm was in
generating a hydrostatic galaxy cluster, one can use the <a class="reference internal" href="_as_gen/model.ClusterModel.check_hse.html#model.ClusterModel.check_hse" title="model.ClusterModel.check_hse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">model.ClusterModel.check_hse()</span></code></a> method, which will provide the maximal relative deviation of the system from hydrostatic equilibrium.</p>
<p>This is done by recalling that the hydrostatic equilibrium condition requires that</p>
<div class="math notranslate nohighlight">
\[-\frac{\nabla P}{\rho_g} = \nabla \Phi.\]</div>
<p>This, we define the hydrostatic variable <span class="math notranslate nohighlight">\(\xi\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\xi = \frac{\nabla \Phi \rho_g + \nabla \Phi}{\nabla \Phi \rho_g}.\]</div>
<p>clearly, <span class="math notranslate nohighlight">\(\xi \approx 0\)</span> indicates a successfully equilibrated cluster.</p>
</section>
<section id="setting-a-magnetic-field-strength-profile">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Setting a Magnetic Field Strength Profile</a><a class="headerlink" href="#setting-a-magnetic-field-strength-profile" title="Link to this heading">#</a></h2>
<p>Magnetic fields play a major role in the dynamics of the ionized plasma modeled in hydro simulations of galaxy clusters. In <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code>, there
are currently two approaches for generating a magnetic field for a galaxy cluster.</p>
<p>Users can specify the magnetic field profile using the <a class="reference internal" href="_as_gen/model.ClusterModel.set_magnetic_field_from_beta.html#model.ClusterModel.set_magnetic_field_from_beta" title="model.ClusterModel.set_magnetic_field_from_beta"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_magnetic_field_from_beta()</span></code></a>, which allows the user
to specify the magnetic pressure factor <span class="math notranslate nohighlight">\(\beta\)</span>, which is defined such that</p>
<div class="math notranslate nohighlight">
\[\beta = \frac{p_{\mathrm{thermal}}}{p_{\mathrm{magnetic}}}.\]</div>
<p>Another common approach for initializing magnetic fields is to let the magnetic field be proportional to a power of the gas density. Most commonly, this value is
<span class="math notranslate nohighlight">\(\eta = \frac{2}{3}\)</span>; however, the user may specify whichever exponent they choose. To initialize a cluster with a magnetic field using this approach, use the <a class="reference internal" href="_as_gen/model.ClusterModel.set_magnetic_field_from_density.html#model.ClusterModel.set_magnetic_field_from_density" title="model.ClusterModel.set_magnetic_field_from_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_magnetic_field_from_density()</span></code></a>.</p>
</section>
<section id="adding-other-fields">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Adding Other Fields</a><a class="headerlink" href="#adding-other-fields" title="Link to this heading">#</a></h2>
<p>Users may add additional fields to the <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterModel</span></code></a> instance using the <a class="reference internal" href="_as_gen/model.ClusterModel.set_field.html#model.ClusterModel.set_field" title="model.ClusterModel.set_field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_field()</span></code></a> method, which takes a
<code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> and loads the corresponding field into the model.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>User’s should be aware that <code class="docutils literal notranslate"><span class="pre">value</span></code>’s being attributed as fields must be <code class="docutils literal notranslate"><span class="pre">unyt_array</span></code>’s, not generic <code class="docutils literal notranslate"><span class="pre">list</span></code> types or <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>. Furthermore,
the length of the value being specified must match <code class="docutils literal notranslate"><span class="pre">ClusterModel.num_elements</span></code>.</p>
</div>
</section>
<section id="reading-and-writing-model-clustermodel-objects-to-and-from-disk">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Reading and Writing <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> Objects to and from Disk</a><a class="headerlink" href="#reading-and-writing-model-clustermodel-objects-to-and-from-disk" title="Link to this heading">#</a></h2>
<div class="admonition-user-advice admonition">
<p class="admonition-title">User Advice</p>
<p>Generating <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> instances can be <strong>slow</strong>. As many cases as possible, it is worthwhile to
write models to disk in one of the formats discussed below so that they can be read more easily.</p>
</div>
<p>Many different protocols for writing and reading <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> instances to / from disk have been implemented. The following table summarizes the
options available; however, we advice consulting the API reference for each of the methods to get more information about specifics regarding each of the available formats.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Write Method</p></th>
<th class="head"><p>Read Method</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ASCII</p></td>
<td><p><a class="reference internal" href="_as_gen/model.ClusterModel.write_model_to_ascii.html#model.ClusterModel.write_model_to_ascii" title="model.ClusterModel.write_model_to_ascii"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_model_to_ascii()</span></code></a></p></td>
<td><p><strong>Not Yet Implemented</strong></p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>HDF5</p></td>
<td><p><a class="reference internal" href="_as_gen/model.ClusterModel.write_model_to_h5.html#model.ClusterModel.write_model_to_h5" title="model.ClusterModel.write_model_to_h5"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_model_to_h5()</span></code></a></p></td>
<td><p><a class="reference internal" href="_as_gen/model.ClusterModel.from_h5_file.html#model.ClusterModel.from_h5_file" title="model.ClusterModel.from_h5_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_h5_file()</span></code></a></p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>BINARY</p></td>
<td><p><a class="reference internal" href="_as_gen/model.ClusterModel.write_model_to_binary.html#model.ClusterModel.write_model_to_binary" title="model.ClusterModel.write_model_to_binary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_model_to_binary()</span></code></a></p></td>
<td><p><strong>Not Yet Implemented</strong></p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
</section>
<section id="non-physical-profiles">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Non-Physical Profiles</a><a class="headerlink" href="#non-physical-profiles" title="Link to this heading">#</a></h2>
<p>Sometimes, for a variety of reasons, generated <a class="reference internal" href="_as_gen/model.ClusterModel.html#model.ClusterModel" title="model.ClusterModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code></a> instances might have profiles which are non-physical. Sometimes, this is caused by a poor choice
of radial profile for the given gravity theory, or is caused because some other physical constraint is not respected. CG has a model (<a class="reference internal" href="_as_gen/correction.html#module-correction" title="correction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">correction</span></code></a>) entirely focused on
fixing these problems. For a comprehensive description of these issues and the algorithms used to solve them, see <a class="reference internal" href="correction.html#correction"><span class="std std-ref">Correcting Non-Physical Behavior</span></a> .</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="examples.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Examples</p>
      </div>
    </a>
    <a class="right-next"
       href="codes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Simulation Software</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-models-mathematical-overview">Cluster Models: Mathematical Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-intracluster-medium-icm">The Intracluster Medium (ICM)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gravity">Gravity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-model-clustermodel-using-radial-profiles">Generating a <code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code> Using Radial Profiles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-hydrostatic-equilibrium">Checking the Hydrostatic Equilibrium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-a-magnetic-field-strength-profile">Setting a Magnetic Field Strength Profile</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-other-fields">Adding Other Fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-and-writing-model-clustermodel-objects-to-and-from-disk">Reading and Writing <code class="xref py py-class docutils literal notranslate"><span class="pre">model.ClusterModel</span></code> Objects to and from Disk</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-physical-profiles">Non-Physical Profiles</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/models.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=c5ced968eda925caa686"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2020, John ZuHone.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>