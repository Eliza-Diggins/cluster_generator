
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Cluster Models &#8212; cluster_generator  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=ccbe24c1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'models';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Particles" href="particles.html" />
    <link rel="prev" title="Radial Profiles" href="radial_profiles.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">cluster_generator  documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="radial_profiles.html">
                        Radial Profiles
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="particles.html">
                        Particles
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="fields.html">
                        Generating 3D Cluster Fields
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="initial_conditions.html">
                        Initial Conditions Generation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="codes.html">
                        Setting Up Idealized Cluster Problems in Various Codes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="radial_profiles.html">
                        Radial Profiles
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="particles.html">
                        Particles
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="fields.html">
                        Generating 3D Cluster Fields
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="initial_conditions.html">
                        Initial Conditions Generation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="codes.html">
                        Setting Up Idealized Cluster Problems in Various Codes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Cluster Models</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="cluster-models">
<span id="id1"></span><h1>Cluster Models<a class="headerlink" href="#cluster-models" title="Permalink to this heading">#</a></h1>
<section id="cluster-models-mathematical-overview">
<span id="math-overview-models"></span><h2>Cluster Models: Mathematical Overview<a class="headerlink" href="#cluster-models-mathematical-overview" title="Permalink to this heading">#</a></h2>
<p>Assuming the intracluster medium of galaxy clusters can be modeled as an
ideal fluid, the momentum density <span class="math notranslate nohighlight">\(\rho{\bf v}\)</span> of the
gas obeys the Euler momentum equation (here written in conservative form
and ignoring magnetic fields, viscosity, etc.):</p>
<div class="math notranslate nohighlight">
\[\frac{\partial({\rho_g{\bf v}})}{\partial{t}} + \nabla \cdot (\rho_g{\bf v}{\bf v})
= -\nabla{P} + \rho_g{\bf g}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_g\)</span> is the gas density, <span class="math notranslate nohighlight">\({\bf v}\)</span> is the gas velocity,
<span class="math notranslate nohighlight">\(P\)</span> is the gas pressure, and <span class="math notranslate nohighlight">\({\bf g}\)</span> is the gravitational
acceleration. The assumption of hydrostatic equilibrium implies that
<span class="math notranslate nohighlight">\({\bf v} = 0\)</span> and that all time derivatives are zero, giving:</p>
<div class="math notranslate nohighlight">
\[\nabla{P} = \rho_g{\bf g}\]</div>
<p>We therefore define the “hydrostatic vector”, <span class="math notranslate nohighlight">\(\Gamma\)</span> of the system to be</p>
<div class="math notranslate nohighlight">
\[\Gamma = -\frac{\nabla P}{\rho_g} = \nabla \Phi.\]</div>
<p>In the context of galaxy clusters, we may typically assume an ideal gas behavior for the ICM, and therefore,</p>
<div class="math notranslate nohighlight">
\[\Gamma = -\frac{\nabla P}{\rho_g} = \frac{-k_b T}{m_p \eta} \left[\frac{d\ln(\rho_g)}{dr} + \frac{d\ln(T)}{dr} \right].\]</div>
<p>As such, we recognize that from <span class="math notranslate nohighlight">\(\rho_g\)</span> and <span class="math notranslate nohighlight">\(T\)</span>, we can generally obtain the acceleration and therefore the dynamical mass
of the system. Because the dynamical mass need not be equivalent to the gasseous mass, it follows that finding the dynamical mass will also
yield the halo mass of the system.</p>
<p>It is worth noting throughout the remainder of this document that for <span class="math notranslate nohighlight">\(r\to \infty\)</span>, if <span class="math notranslate nohighlight">\(\rho \sim r^\alpha\)</span> and <span class="math notranslate nohighlight">\(T\sim r^\beta\)</span>,
then</p>
<div class="math notranslate nohighlight">
\[\Gamma \sim r^{\beta-1}.\]</div>
<p>This point becomes important as we begin discussing the interaction between the gas dynamics above and the potential of the system.</p>
<p>It is here that the theory begins to diverge dependent on the theoretical context on which the gravity of your system is
based.</p>
<section id="newtonian-gravity">
<h3>Newtonian Gravity<a class="headerlink" href="#newtonian-gravity" title="Permalink to this heading">#</a></h3>
<p>If the model relies on Newtonian gravity, then <span class="math notranslate nohighlight">\(\nabla \Phi = GM_{\mathrm{dyn}}(&lt;r)/r^2\)</span>, and therefore, the
dynamical mass is</p>
<div class="math notranslate nohighlight">
\[M_{\mathrm{dyn}}(&lt;r) = \frac{r^2}{G}\Gamma = \frac{-r^2 k_b T}{G m_p \eta} \left[\frac{d\ln(\rho_g)}{dr} + \frac{d\ln(T)}{dr} \right]\]</div>
<p>Thus, the dynamical mass may be directly obtained and the halo mass found by simply removing the known baryonic component. It should be noted that
for <span class="math notranslate nohighlight">\(M_{\mathrm{dyn}}(&lt;r)\)</span> to be asymptotically constant for large <span class="math notranslate nohighlight">\(r\)</span>,</p>
<div class="math notranslate nohighlight">
\[M_{\mathrm{dyn}} \sim r^2\Gamma \sim r^{\beta + 1} = r^0,\]</div>
<p>Therefore, <span class="math notranslate nohighlight">\(T \sim 1/r\)</span> for a stable dynamical mass profile at large radii.</p>
</section>
<section id="mond-gravity-aqual">
<h3>MOND Gravity: AQUAL<a class="headerlink" href="#mond-gravity-aqual" title="Permalink to this heading">#</a></h3>
<p>In the case of AQUAL, the mass and the acceleration are instead related by the modified Poisson equation, which implies that</p>
<div class="math notranslate nohighlight">
\[M_{\mathrm{dyn}} = \frac{r^2}{G}\mu\left(\frac{| \Gamma |}{a_0}\right)\Gamma.\]</div>
<p>Similar to the case in Newtonian dynamics, this can simply be taken directly to obtain the correct form of the dynamical mass; however, it should
be noted that the asymptotic stability conditions are not the same as in Newtonian gravity. Specifically, in the deep-MOND regime, where <span class="math notranslate nohighlight">\(\mu(x) \approx x\)</span>,</p>
<div class="math notranslate nohighlight">
\[M_{\mathrm{dyn}} \approx \frac{r^2}{G}\frac{\Gamma^2}{a_0} \sim r^2r^{2\beta-2},\]</div>
<p>and thus <span class="math notranslate nohighlight">\(\beta = 0\)</span> is required for a stable dynamical mass profile.</p>
</section>
<section id="mond-gravity-qumond">
<h3>MOND Gravity: QUMOND<a class="headerlink" href="#mond-gravity-qumond" title="Permalink to this heading">#</a></h3>
<p>In QUMOND, the situation is more complex. The necessary equation becomes</p>
<div class="math notranslate nohighlight">
\[\mu\left(\frac{|\nabla \Psi |}{a_0}\right)\nabla \Psi = \Gamma,\;\;\nabla \Psi = \frac{GM_{\mathrm{dyn}}}{r^2}\]</div>
<p>This form is not analytically solvable for general <span class="math notranslate nohighlight">\(\mu\)</span>; however, implicit solutions can be found numerically which provide the
dynamical mass distribution. Again, in the DMR, the equation simplifies to the form</p>
<div class="math notranslate nohighlight">
\[\frac{G^2M_{\mathrm{dyn}}^2}{r^4 a_0} = \Gamma \implies M_{\mathrm{dyn}} \sim r^2 \sqrt{\Gamma} \sim \sqrt{r{3+\beta}},\]</div>
<p>Thus, <span class="math notranslate nohighlight">\(T(r) \sim r^{-3}\)</span> at large radii for a stable dynamical mass profile. These results are summarized in the table below.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Gravity Type</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\Gamma\)</span> and <span class="math notranslate nohighlight">\(\Phi\)</span> relationship</p></th>
<th class="head"><p>Mass Stability Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Newtonian</p></td>
<td><p><span class="math notranslate nohighlight">\(\Gamma = \nabla \Phi = GM_{\mathrm{dyn}}(&lt;r)/r^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T\sim r^{-1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>AQUAL</p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\left(\frac{|\Gamma|}{a_0}\right)\Gamma = GM_{\mathrm{dyn}}(&lt;r)/r^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T\sim r^{0}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>QUMOND</p></td>
<td><p><span class="math notranslate nohighlight">\(\Gamma = \mu\left(\frac{|\nabla \Psi|}{a_0}\right) \nabla \Psi\)</span> where
<span class="math notranslate nohighlight">\(\nabla \Psi = GM_{\mathrm{dyn}}(&lt;r)/r^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T\sim r^{-3}\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="dealing-with-non-convergent-mass-profiles">
<h3>Dealing With Non-Convergent Mass Profiles<a class="headerlink" href="#dealing-with-non-convergent-mass-profiles" title="Permalink to this heading">#</a></h3>
<p>It is entirely possible to consider clusters wherein <span class="math notranslate nohighlight">\(T\)</span> does not behave in the correct way at large radii to be
assymptotically consistent with the chosen gravity theory. In cases where <span class="math notranslate nohighlight">\(\beta &lt; \beta_0\)</span> (where <span class="math notranslate nohighlight">\(\beta_0\)</span> is the
necessary stable behavior of <span class="math notranslate nohighlight">\(T\)</span>) the temperature drops off too quickly and
the dynamical mass profile will reach a maxima at some <span class="math notranslate nohighlight">\(r_{\mathrm{max}}\)</span> before falling to 0. Beyond this maxima, the system is
clearly non-physical and could not possibly be initialized in a simulation.</p>
<p>Similarly, if <span class="math notranslate nohighlight">\(\beta &gt; \beta_0\)</span>, the dynamical mass will fail to converge and instead increase monotonically.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>To solve this issue, the <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code> package will impose an artificial constraint on the system. At
<span class="math notranslate nohighlight">\(r_{\mathrm{truncate}} = 2r_{200}\)</span>, the temperature profile is altered (for the dynamical mass computation only) such that</p>
<div class="math notranslate nohighlight">
\[T_{\mathrm{truncated}}(r) = T(r) \cdot \left(\frac{r}{r_{\mathrm{truncate}}}\right)^{\beta_0 - \beta}\]</div>
<p>Which will induce asymptotic convergence.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the user specifies the <code class="docutils literal notranslate"><span class="pre">change_T</span></code> kwarg in the <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> object, then the altered <span class="math notranslate nohighlight">\(T\)</span> will be
used as the consistent temperature profile of the entire model, thus saving HSE to a perfect degree, but changing the
user’s intended temperature profile. If <code class="docutils literal notranslate"><span class="pre">change_T</span> <span class="pre">==</span> <span class="pre">False</span></code> (default), the cluster’s temperature profile remains the same, but
the dynamical mass is computed using the altered temperature profile. Thus the user’s configuration is saved, but the
resultant cluster may not be in perfect HSE.</p>
</div>
</section>
</section>
<section id="generating-a-clustermodel-using-radial-profiles">
<h2>Generating a <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> Using Radial Profiles<a class="headerlink" href="#generating-a-clustermodel-using-radial-profiles" title="Permalink to this heading">#</a></h2>
<p>The above equations can be solved for in a number of ways,
depending on what the initial assumptions are.</p>
<section id="clustermodel-from-gas-density-and-gas-temperature-profiles">
<h3><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> from Gas Density and Gas Temperature Profiles<a class="headerlink" href="#clustermodel-from-gas-density-and-gas-temperature-profiles" title="Permalink to this heading">#</a></h3>
<p>When the gas density and gas temperature are specified, the condition of hydrostatic equilibrium can be used to
provide the necessary halo. From the Euler momentum equation, <span class="math notranslate nohighlight">\(-\nabla P / \rho_g = \Gamma(T,\rho_g) = \nabla \Phi\)</span>. As such
the relationship between <span class="math notranslate nohighlight">\(\nabla \Phi\)</span> and <span class="math notranslate nohighlight">\(\Gamma\)</span> is exploited to determine the total dynamical mass of the system. From
the dynamical mass profile, the necessary dark matter profile becomes</p>
<div class="math notranslate nohighlight">
\[M_{dm} = M_{\mathrm{dyn}} - M_{\mathrm{bary}}.\]</div>
</section>
<section id="clustermodel-from-gas-density-and-total-density-profiles">
<h3><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> from Gas Density and Total Density Profiles<a class="headerlink" href="#clustermodel-from-gas-density-and-total-density-profiles" title="Permalink to this heading">#</a></h3>
<p>In the case where the dynamical density is already known, the halo mass function is trivially obtained from</p>
<div class="math notranslate nohighlight">
\[\rho_{\mathrm{halo}} = \rho_{\mathrm{dyn}} - \rho_{\mathrm{bary}},\]</div>
<p>where the baryonic component may contain a stellar distribution if the user supplies one. The difficult in this case
is to efficiently determine the temperature profile which yields HSE. Recalling that</p>
<div class="math notranslate nohighlight">
\[\Gamma = -\frac{\nabla P}{\rho_g} = \frac{-k_b T}{m_p \eta} \left[\frac{d\ln(\rho_g)}{dr} + \frac{d\ln(T)}{dr} \right].\]</div>
<p>The differential equation may be inverted, yielding</p>
<div class="math notranslate nohighlight">
\[T(r) = \frac{-m_p \eta}{k_b \rho_g} \int_{r_0}^r \rho_g(r') \nabla \Phi(r') dr' + \frac{\rho_g(r_0)}{\rho_g(r)}T(r_0).\]</div>
<p>The most efficient approach here is to take <span class="math notranslate nohighlight">\(r_0 = \infty\)</span>, in which case,</p>
<div class="math notranslate nohighlight">
\[T(r) = \frac{m_p \eta}{k_b \rho_g} \int_{r}^\infty \rho_g(r') \nabla \Phi(r') dr'.\]</div>
<p>From this, the temperature profile is obtained.</p>
</section>
<section id="clustermodel-from-gas-density-and-gas-entropy-profiles">
<h3><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> from Gas Density and Gas Entropy Profiles<a class="headerlink" href="#clustermodel-from-gas-density-and-gas-entropy-profiles" title="Permalink to this heading">#</a></h3>
</section>
<section id="clustermodel-without-gas">
<h3><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> Without Gas<a class="headerlink" href="#clustermodel-without-gas" title="Permalink to this heading">#</a></h3>
<p>If you want to model a dark matter halo without gas (but potentially with stars),
set up a total density profile using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">no_gas()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cluster_generator</span> <span class="k">as</span> <span class="nn">cg</span>
<span class="c1"># Create a Hernquist total density profile</span>
<span class="n">M_0</span> <span class="o">=</span> <span class="mf">5e14</span> <span class="c1"># units of Msun</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">500.0</span> <span class="c1"># units of kpc</span>
<span class="n">total_density</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">hernquist_density_profile</span><span class="p">(</span><span class="n">M_0</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="c1"># Create the virial model</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># minimum radius in kpc</span>
<span class="n">rmax</span> <span class="o">=</span> <span class="mf">10000.0</span> <span class="c1"># maximum radius in kpc</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># the number of samples along the radial profile, optional</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">ClusterModel</span><span class="o">.</span><span class="n">no_gas</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">total_density</span><span class="p">,</span>
                           <span class="n">num_points</span><span class="o">=</span><span class="n">num_points</span><span class="p">)</span>
</pre></div>
</div>
<p>If there are stars in the cluster model (and not dark matter only) then it is
possible to supply a stellar mass density profile as well via the
<code class="docutils literal notranslate"><span class="pre">stellar_density</span></code> argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cluster_generator</span> <span class="k">as</span> <span class="nn">cg</span>
<span class="c1"># Create a Hernquist total density profile</span>
<span class="n">M_0</span> <span class="o">=</span> <span class="mf">5e14</span> <span class="c1"># units of Msun</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">500.0</span> <span class="c1"># units of kpc</span>
<span class="n">total_density</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">hernquist_density_profile</span><span class="p">(</span><span class="n">M_0</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="c1"># Create the virial model</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># minimum radius in kpc</span>
<span class="n">rmax</span> <span class="o">=</span> <span class="mf">10000.0</span> <span class="c1"># maximum radius in kpc</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># the number of samples along the radial profile, optional</span>
<span class="c1"># Create a Hernquist stellar density profile</span>
<span class="n">M_star</span> <span class="o">=</span> <span class="mf">5.0e12</span> <span class="c1"># units of Msun</span>
<span class="n">a_star</span> <span class="o">=</span> <span class="mf">50.0</span> <span class="c1"># units of kpc</span>
<span class="n">stellar_density</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">hernquist_density_profile</span><span class="p">(</span><span class="n">M_star</span><span class="p">,</span> <span class="n">a_star</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">ClusterModel</span><span class="o">.</span><span class="n">no_gas</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">total_density</span><span class="p">,</span>
                           <span class="n">stellar_density</span><span class="o">=</span><span class="n">stellar_density</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="checking-the-hydrostatic-equilibrium">
<h2>Checking the Hydrostatic Equilibrium<a class="headerlink" href="#checking-the-hydrostatic-equilibrium" title="Permalink to this heading">#</a></h2>
</section>
<section id="setting-a-magnetic-field-strength-profile">
<h2>Setting a Magnetic Field Strength Profile<a class="headerlink" href="#setting-a-magnetic-field-strength-profile" title="Permalink to this heading">#</a></h2>
</section>
<section id="adding-other-fields">
<h2>Adding Other Fields<a class="headerlink" href="#adding-other-fields" title="Permalink to this heading">#</a></h2>
</section>
<section id="reading-and-writing-clustermodel-objects-to-and-from-disk">
<h2>Reading and Writing <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> Objects to and from Disk<a class="headerlink" href="#reading-and-writing-clustermodel-objects-to-and-from-disk" title="Permalink to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="radial_profiles.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Radial Profiles</p>
      </div>
    </a>
    <a class="right-next"
       href="particles.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Particles</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-models-mathematical-overview">Cluster Models: Mathematical Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#newtonian-gravity">Newtonian Gravity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mond-gravity-aqual">MOND Gravity: AQUAL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mond-gravity-qumond">MOND Gravity: QUMOND</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-non-convergent-mass-profiles">Dealing With Non-Convergent Mass Profiles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-clustermodel-using-radial-profiles">Generating a <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> Using Radial Profiles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustermodel-from-gas-density-and-gas-temperature-profiles"><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> from Gas Density and Gas Temperature Profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustermodel-from-gas-density-and-total-density-profiles"><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> from Gas Density and Total Density Profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustermodel-from-gas-density-and-gas-entropy-profiles"><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> from Gas Density and Gas Entropy Profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustermodel-without-gas"><code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> Without Gas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-hydrostatic-equilibrium">Checking the Hydrostatic Equilibrium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-a-magnetic-field-strength-profile">Setting a Magnetic Field Strength Profile</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-other-fields">Adding Other Fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-and-writing-clustermodel-objects-to-and-from-disk">Reading and Writing <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> Objects to and from Disk</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/models.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2020, John ZuHone.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>