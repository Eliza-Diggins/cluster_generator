
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Correcting Non-Physical Behavior &#8212; cluster_generator  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=c5ced968eda925caa686" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=c5ced968eda925caa686" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=c5ced968eda925caa686"></script>

    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/hoverxref.js"></script>
    <script src="_static/js/tooltipster.bundle.min.js"></script>
    <script src="_static/js/micromodal.min.js"></script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'correction';</script>
    <link rel="icon" href="_static/cluster_generator_logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/cluster_generator_logo.png" class="logo__image only-light" alt="cluster_generator  documentation - Home"/>
    <script>document.write(`<img src="_static/cluster_generator_logo.png" class="logo__image only-dark" alt="cluster_generator  documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="models.html">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="codes.html">
                        Simulation Software
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="models.html">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="codes.html">
                        Simulation Software
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Correcting...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="correcting-non-physical-behavior">
<span id="correction"></span><h1><a class="toc-backref" href="#id3" role="doc-backlink">Correcting Non-Physical Behavior</a><a class="headerlink" href="#correcting-non-physical-behavior" title="Link to this heading">#</a></h1>
<p>In many cases, perfectly reasonable initial profiles (be they <span class="math notranslate nohighlight">\(\rho_g\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(\rho_{\mathrm{dyn}}\)</span> or others)
can lead to manifestly non-physical final clusters when all of the calculations have been made. There are generally 3 reasons why
this can occur:</p>
<ul class="simple">
<li><p><strong>The profiles are explicitly flawed</strong></p>
<ul>
<li><p>Example: You ask CG to create initial conditions for a negative ICM temperature.</p></li>
</ul>
</li>
<li><p><strong>The profiles lead to non-physicalities because of their shapes</strong></p>
<ul>
<li><p>Example: You create a gas density profile and a temperature profile, but they’re not intrinsically connected. Sometimes they
won’t be viable together in a single system.</p></li>
<li><p>Another case in which this occurs regularly is that <span class="math notranslate nohighlight">\(\rho_g\)</span> and <span class="math notranslate nohighlight">\(T_g\)</span> profiles in the literature are only constructed
on a particular domain and are fit independent of any constraints they impose on one another. While this is fine for many observational
purposes, it can lead to inconsistencies.</p></li>
</ul>
</li>
<li><p><strong>The gravity theory you’ve chosen causes problems</strong></p>
<ul>
<li><p>Example: You choose a temperature profile that goes as <span class="math notranslate nohighlight">\(1/r\)</span> at large radii, but you’re also using MOND gravity where
<span class="math notranslate nohighlight">\(T_g \sim r^0\)</span> for asymptotic stability.</p></li>
</ul>
</li>
</ul>
<p>Clearly, there are a variety of ways that these things can happen and they’re often hard to predict as the end user. In previous
initial conditions software, it was generally left up to the end user to construct self-consistent profiles (which could be a lot of work).
CG is geared toward making the initialization process as simple as possible to facilitate easier science and therefore
comes with a set of algorithms for detection and correction of these non-physicalities.</p>
<hr style="height:10px;background-color:black"><nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#correcting-non-physical-behavior" id="id3">Correcting Non-Physical Behavior</a></p>
<ul>
<li><p><a class="reference internal" href="#non-physical-regions" id="id4">Non-Physical Regions</a></p>
<ul>
<li><p><a class="reference internal" href="#type-0-non-physicalities" id="id5">Type 0 Non-Physicalities</a></p></li>
<li><p><a class="reference internal" href="#type-1-non-physicalities" id="id6">Type 1 Non-Physicalities</a></p></li>
<li><p><a class="reference internal" href="#type-2-non-physicalities" id="id7">Type 2 Non-Physicalities</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id1" id="id8">Correcting Non-Physical Behavior</a></p></li>
<li><p><a class="reference internal" href="#adding-a-new-npr" id="id9">Adding a New NPR</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr style="height:10px;background-color:black"><section id="non-physical-regions">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Non-Physical Regions</a><a class="headerlink" href="#non-physical-regions" title="Link to this heading">#</a></h2>
<p>To contend with the issue of non-physical regions, CG provides the <a class="reference internal" href="_as_gen/correction.html#module-correction" title="correction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">correction</span></code></a> module which is composed of
class objects descended from <a class="reference internal" href="_as_gen/correction.NonPhysicalRegion.html#correction.NonPhysicalRegion" title="correction.NonPhysicalRegion"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.NonPhysicalRegion</span></code></a>. Each of these classes represents a particular category of
non-physical region and has subclasses representing the documented sub-cases of the non-physicality described. As such, to get
started correcting non-physical regions, it is first important to understand how they are categorized.</p>
<figure class="align-default" id="id2">
<img alt="Non-physicalities diagram." src="_images/non-physical.drawio.png" />
<figcaption>
<p><span class="caption-text">All of the possible non-physicalities which occur in CG.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="type-0-non-physicalities">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Type 0 Non-Physicalities</a><a class="headerlink" href="#type-0-non-physicalities" title="Link to this heading">#</a></h3>
<p class="rubric">Non Physical Region Classes</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_as_gen/correction.Type0NPR.html#correction.Type0NPR" title="correction.Type0NPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Type0NPR</span></code></a>(rmin, rmax, obj)</p></td>
<td><p>Non-Physical Region marker class (Subclass of <a class="reference internal" href="_as_gen/correction.NonPhysicalRegion.html#correction.NonPhysicalRegion" title="correction.NonPhysicalRegion"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.NonPhysicalRegion</span></code></a>) which indicates NPRs of type 0.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_as_gen/correction.Type0aNPR.html#correction.Type0aNPR" title="correction.Type0aNPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Type0aNPR</span></code></a>(rmin, rmax, obj)</p></td>
<td><p>Subclass of <a class="reference internal" href="_as_gen/correction.Type0NPR.html#correction.Type0NPR" title="correction.Type0NPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0NPR</span></code></a> which indicates a non-physical region associated with negative entropy or temperature regions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="_as_gen/correction.Type0bNPR.html#correction.Type0bNPR" title="correction.Type0bNPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Type0bNPR</span></code></a>(rmin, rmax, obj)</p></td>
<td><p>Subclass of <a class="reference internal" href="_as_gen/correction.Type0NPR.html#correction.Type0NPR" title="correction.Type0NPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0NPR</span></code></a> which indicates a non-physical region associated with negative density profiles.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_as_gen/correction.Type0cNPR.html#correction.Type0cNPR" title="correction.Type0cNPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Type0cNPR</span></code></a>(rmin, rmax, obj)</p></td>
<td><p>Subclass of <a class="reference internal" href="_as_gen/correction.Type0NPR.html#correction.Type0NPR" title="correction.Type0NPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0NPR</span></code></a> which indicates a non-physical region associated with a cause not elsewhere specified.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Causes</p>
<p>Type 0 non-physicalities occur when something is explicitly wrong with the profiles the user has provided.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
From <span class="math notranslate nohighlight">\(\rho_g + T_g\)</span></label><div class="sd-tab-content docutils">
<p>If the density profile is found to be negative, then it will result in a <a class="reference internal" href="_as_gen/correction.Type0bNPR.html#correction.Type0bNPR" title="correction.Type0bNPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0bNPR</span></code></a> instance. If
the temperature profile is inconsistent, then it will result in a <a class="reference internal" href="_as_gen/correction.Type0aNPR.html#correction.Type0aNPR" title="correction.Type0aNPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0aNPR</span></code></a>.</p>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
From <span class="math notranslate nohighlight">\(\rho_g + \rho_{\mathrm{dyn}}\)</span></label><div class="sd-tab-content docutils">
<p>A <a class="reference internal" href="_as_gen/correction.Type0bNPR.html#correction.Type0bNPR" title="correction.Type0bNPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0bNPR</span></code></a> occurs if any of the following happen:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho_g &lt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{\mathrm{dyn}} &lt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_g &gt; \rho_{\mathrm{dyn}}\)</span></p></li>
</ul>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-2">
From <span class="math notranslate nohighlight">\(\rho_g + S_g\)</span></label><div class="sd-tab-content docutils">
<p>The <span class="math notranslate nohighlight">\(\rho_g + S_g\)</span> approach is entirely equivalent to the <span class="math notranslate nohighlight">\(\rho_g+T_g\)</span> approach. Given that
If the density profile is found to be negative, then it will result in a <a class="reference internal" href="_as_gen/correction.Type0bNPR.html#correction.Type0bNPR" title="correction.Type0bNPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0bNPR</span></code></a> instance. If
the entropy profile is inconsistent, then it will result in a <a class="reference internal" href="_as_gen/correction.Type0aNPR.html#correction.Type0aNPR" title="correction.Type0aNPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0aNPR</span></code></a>.</p>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-3">
Without gas</label><div class="sd-tab-content docutils">
<p>A <a class="reference internal" href="_as_gen/correction.Type0bNPR.html#correction.Type0bNPR" title="correction.Type0bNPR"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.Type0bNPR</span></code></a> arises if the input density profile is negative.</p>
</div>
</div>
</section>
<section id="type-1-non-physicalities">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Type 1 Non-Physicalities</a><a class="headerlink" href="#type-1-non-physicalities" title="Link to this heading">#</a></h3>
<p class="rubric">Non Physical Region Classes</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_as_gen/correction.Type1NPR.html#correction.Type1NPR" title="correction.Type1NPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Type1NPR</span></code></a>(rmin, rmax, obj)</p></td>
<td><p>Non-Physical Region marker class (Subclass of <a class="reference internal" href="_as_gen/correction.NonPhysicalRegion.html#correction.NonPhysicalRegion" title="correction.NonPhysicalRegion"><code class="xref py py-class docutils literal notranslate"><span class="pre">correction.NonPhysicalRegion</span></code></a>) which indicates NPRs of type 1.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_as_gen/correction.Type1aNPR.html#correction.Type1aNPR" title="correction.Type1aNPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Type1aNPR</span></code></a>(rmin, rmax, obj)</p></td>
<td><p>Non-Physical Region corresponding to regions of the cluster where the growth rates of the gas temperature and density are inconsistent with a positive gravitational field.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Causes</p>
<p>Type 1 non-physical regions are the most commonly occurring class. These arise when some aspect of the provided profiles
is inconsistent during later steps of the computation process.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-4">
From <span class="math notranslate nohighlight">\(\rho_g + T_g\)</span></label><div class="sd-tab-content docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <span class="math notranslate nohighlight">\(\rho_g + T_g\)</span> approach is the most temperamental of the generation approaches; however it is also
the most useful for matching observational properties of clusters. We therefore encourage every user to understand
the non-physicalities described in this section.</p>
</div>
<p>In the <span class="math notranslate nohighlight">\(\rho_g + T_g\)</span> approach, temperature and density profiles are provided from which HSE is used to determine the gravitational field. From
the field, we can finally determine the dynamical mass. If both <span class="math notranslate nohighlight">\(\rho_g, T_g\)</span> are self-consistent, then the gravitational field follows from HSE as</p>
<div class="math notranslate nohighlight">
\[\nabla \Phi = \frac{-k_b T}{m_p \eta} \left[\frac{d\ln(\rho_g)}{dr} + \frac{d\ln(T)}{dr} \right].\]</div>
<p>If <strong>both profiles are monotonically decreasing</strong>, then <span class="math notranslate nohighlight">\(\nabla \Phi &gt; 0\)</span> which is consistent. The criterion for a non-physicality is (by Gauss’ Law) that
<span class="math notranslate nohighlight">\(\nabla \Phi &gt; 0\)</span>. Therefore, an inconsistency arises if the derivative factor of the expression is non-negative.</p>
<div class="admonition-type-1-non-physicalities admonition">
<p class="admonition-title">Type 1 Non-Physicalities</p>
<p>There are three Type 1 non-physicalities which can arise in this case:</p>
<ul class="simple">
<li><p><strong>Type 1a-1</strong>: <span class="math notranslate nohighlight">\(\nabla_r \rho_g &gt; 0\)</span> and <span class="math notranslate nohighlight">\(|\nabla_r \ln(T_g)| &lt; |\nabla_r \ln(\rho_g)|\)</span>. (The density is increasing too fast)</p></li>
<li><p><strong>Type 1a-2</strong>: <span class="math notranslate nohighlight">\(\nabla_r T_g &gt; 0\)</span> and <span class="math notranslate nohighlight">\(|\nabla_r \ln(T_g)| &gt; |\nabla_r \ln(\rho_g)|\)</span>. (The temperature is increasing too fast)</p></li>
<li><p><strong>Type 1a-3</strong>: <span class="math notranslate nohighlight">\(\nabla_r T_g &gt; 0\)</span> and <span class="math notranslate nohighlight">\(\nabla_r \rho_g &gt; 0\)</span>.</p></li>
</ul>
</div>
<p>Of these, Type 1a-2 is by far the most common because in <strong>cool-core clusters</strong>, the temperature gradient does go positive and therefore must be
limited.</p>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-5">
From <span class="math notranslate nohighlight">\(\rho_g + \rho_{\mathrm{dyn}}\)</span></label><div class="sd-tab-content docutils">
<p>The <span class="math notranslate nohighlight">\(\rho_g + \rho_{\mathrm{dyn}}\)</span> approach is almost entirely self consistent. Only Type 0 non-physicalities occur
in this case.</p>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-6">
From <span class="math notranslate nohighlight">\(\rho_g + S_g\)</span></label><div class="sd-tab-content docutils">
<p>The <span class="math notranslate nohighlight">\(\rho_g + S_g\)</span> approach is entirely equivalent to the <span class="math notranslate nohighlight">\(\rho_g+S_g\)</span> approach. Given that</p>
<div class="math notranslate nohighlight">
\[S(r) = k_bT_g(r)n_e(r)^{-2/3},\]</div>
<p>A temperature profile is immediately specified which must meet all of the criteria for the temperature profile in the <span class="math notranslate nohighlight">\(\rho_g + T_g\)</span> approach.</p>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-7">
Without gas</label><div class="sd-tab-content docutils">
<p>This approach is entirely self-consistent as long as the density profile provided is physical.</p>
</div>
</div>
</section>
<section id="type-2-non-physicalities">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Type 2 Non-Physicalities</a><a class="headerlink" href="#type-2-non-physicalities" title="Link to this heading">#</a></h3>
<p>Type 2 Non-Physical regions occur when some aspect of the gravitational theory being used is inconsistent with the
profiles provided and thus leads to non-physical results.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These classes will be implemented with the upcoming gravity update.</p>
</div>
<hr style="height:10px;background-color:black"></section>
</section>
<section id="id1">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Correcting Non-Physical Behavior</a><a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Now that we’ve established the types of non-physical regions (NPRs), we are ready to discuss how to fix them. Some non-physical regions
are not reparable (largely because they indicate a failure that we deem should be made obvious to the user); however, wherever possible we
have constructed purpose built algorithms to provide the best possible reconstruction methods to excise NPRs.</p>
<p>The core utility of the <a class="reference internal" href="_as_gen/correction.html#module-correction" title="correction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">correction</span></code></a> module is not simply to categorize NPRs but also to fix them. As such, every
class in the module has two core methods: <a class="reference internal" href="_as_gen/correction.NonPhysicalRegion.identify.html#correction.NonPhysicalRegion.identify" title="correction.NonPhysicalRegion.identify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">correction.NonPhysicalRegion.identify()</span></code></a> and <a class="reference internal" href="_as_gen/correction.NonPhysicalRegion.correct.html#correction.NonPhysicalRegion.correct" title="correction.NonPhysicalRegion.correct"><code class="xref py py-meth docutils literal notranslate"><span class="pre">correction.NonPhysicalRegion.correct()</span></code></a>. These
attempt to identify the NPRs corresponding to that type and correct them respectively. Each takes a <code class="docutils literal notranslate"><span class="pre">recursive</span></code> keyword argument which will tell
the system whether or not to check all of the available subclasses in the same way. In some cases, an NPR isn’t fixable in which case a <code class="xref py py-class docutils literal notranslate"><span class="pre">correction.CorrectionFailure</span></code> will
be raised indicating that an error has occurred. In most cases, these are used to indicate that the user has made an error which is severe enough to warrant a complete reconsideration
of the model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more examples on how this process works in practice, visit the <a class="reference internal" href="examples.html#examples"><span class="std std-ref">Examples</span></a> page. For a more in-depth explanation of
correction methodologies, visit <a class="reference internal" href="correction_methods.html#correction-methods"><span class="std std-ref">Methods For Correcting Non-Physical Regions</span></a>.</p>
</div>
</section>
<section id="adding-a-new-npr">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Adding a New NPR</a><a class="headerlink" href="#adding-a-new-npr" title="Link to this heading">#</a></h2>
<p>If you’re a contributor to CG, then you may find yourself in a situation where you need to add a new NPR type to the
<a class="reference internal" href="_as_gen/correction.html#module-correction" title="correction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">correction</span></code></a> module. The process to do so is relatively simple. Every novel NPR class should fit into a category and
inherit directly from the next highest level NPR in the tree. The generic template for such an addition should look like this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Type__NPR</span><span class="p">(</span><span class="n">Type__NPR</span><span class="p">):</span>
<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Non-Physical Region corresponding to regions of the cluster where **INSERT YOUR DESCRIPTION**.</span>

<span class="sd">+--------------+-----------------------------+</span>
<span class="sd">| Properties                                 |</span>
<span class="sd">+==============+=============================+</span>
<span class="sd">| Scope        | Type &lt;type&gt;                 |</span>
<span class="sd">+--------------+-----------------------------+</span>
<span class="sd">| Methods      | &lt;methods&gt;                   |</span>
<span class="sd">+--------------+-----------------------------+</span>
<span class="sd">| Gravity      | &lt;grav types&gt;                |</span>
<span class="sd">+--------------+-----------------------------+</span>
<span class="sd">| Correctable? | &lt;correctable&gt;               |</span>
<span class="sd">+--------------+-----------------------------+</span>

<span class="sd">**Class Diagram**</span>


<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">Documentation notes.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="n">_message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">NPR of type &lt;type&gt;: &lt;Your description of the new NPR&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">_scope</span> <span class="o">=</span> <span class="s2">&quot;&lt;type&gt;&quot;</span>
<span class="n">correctable</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># --&gt; Is this NPR correctable?</span>

<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

<span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">_identify</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">nprs</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># The NPRs being returned</span>


    <span class="c1">#</span>
    <span class="c1"># YOUR CODE TO IDENTIFY THE NPR GOES HERE.</span>
    <span class="c1">#</span>
    <span class="k">return</span> <span class="n">nprs</span>

<span class="k">def</span> <span class="nf">_correct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="c1">#</span>
    <span class="c1"># YOUR CORRECTION CODE GOES HERE.</span>
    <span class="c1">#</span>

    <span class="k">return</span> <span class="n">New_Model</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-physical-regions">Non-Physical Regions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-0-non-physicalities">Type 0 Non-Physicalities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-1-non-physicalities">Type 1 Non-Physicalities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-2-non-physicalities">Type 2 Non-Physicalities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Correcting Non-Physical Behavior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-new-npr">Adding a New NPR</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/correction.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=c5ced968eda925caa686"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2020, John ZuHone.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>