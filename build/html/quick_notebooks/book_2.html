
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Building Your First Cluster &#8212; cluster_generator  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fd506691" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=ccbe24c1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'quick_notebooks/book_2';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="book_3.html" />
    <link rel="prev" title="Using Radial Profiles" href="book_1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">cluster_generator  documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../Getting_Started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../radial_profiles.html">
                        Radial Profiles
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../models.html">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../particles.html">
                        Particles
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../fields.html">
                        Generating 3D Cluster Fields
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../initial_conditions.html">
                        Initial Conditions Generation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../codes.html">
                        Setting Up Idealized Cluster Problems in Various Codes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../Getting_Started.html">
                        Quickstart Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../radial_profiles.html">
                        Radial Profiles
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../models.html">
                        Cluster Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../particles.html">
                        Particles
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../fields.html">
                        Generating 3D Cluster Fields
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../initial_conditions.html">
                        Initial Conditions Generation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../codes.html">
                        Setting Up Idealized Cluster Problems in Various Codes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Guides:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book_1.html">Using Radial Profiles</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Building Your First Cluster</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../Getting_Started.html" class="nav-link">Quickstart Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Building Your First Cluster</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="Building-Your-First-Cluster">
<h1>Building Your First Cluster<a class="headerlink" href="#Building-Your-First-Cluster" title="Permalink to this heading">#</a></h1>
<p>In this guide, we will demonstrate how to make your own galaxy cluster model using the <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> class. The <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> class is essentially a data container which holds all of the “fields” (density, temperature, etc.) related to that galaxy cluster. Fields can be accessed directly using the <code class="docutils literal notranslate"><span class="pre">ClusterModel.fields</span></code> attribute, and are stored as <code class="docutils literal notranslate"><span class="pre">unyt_arrays</span></code> so that they can carry units. Generally, <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> instances are generated from just 1 or 2 known <code class="docutils literal notranslate"><span class="pre">RadialProfile</span></code>
objects, and then the backend computes the remaining fields of interest behind the scenes. Let’s see this in action. The first step is to make the radial profiles:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports #</span>
<span class="kn">import</span> <span class="nn">cluster_generator</span> <span class="k">as</span> <span class="nn">cg</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># making the radial profiles #</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">hernquist_density_profile</span><span class="p">(</span><span class="mf">1e14</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># The gas density profile</span>
<span class="n">tden</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">nfw_density_profile</span><span class="p">(</span><span class="mf">1e5</span><span class="p">,</span><span class="mi">1200</span><span class="p">)</span> <span class="c1"># The total density</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">dens</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\rho_g$&quot;</span><span class="p">)</span>
<span class="n">tden</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\rho_{\mathrm</span><span class="si">{dyn}</span><span class="s2">}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quick_notebooks_book_2_1_0.png" src="../_images/quick_notebooks_book_2_1_0.png" />
</div>
</div>
<p>Once we have the radial profiles ready to go, its time to make the actual model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Making the ClusterModel object #</span>
<span class="n">dens_tden_model</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ClusterModel</span><span class="o">.</span><span class="n">from_dens_and_tden</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="n">dens</span><span class="p">,</span><span class="n">tden</span><span class="p">,</span><span class="n">stellar_density</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">num_points</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span><span class="n">gravity</span><span class="o">=</span><span class="s2">&quot;Newtonian&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-08-23 09:09:09,795 Computing the profiles from density and total density. Gravity=Newtonian
cluster_generator : [INFO     ] 2023-08-23 09:09:09,800 Integrating total mass profile.
cluster_generator : [INFO     ] 2023-08-23 09:09:09,983 ClusterModel [ClusterModel object; gravity=Newtonian] has no virialization method. Setting to default = eddington
cluster_generator : [INFO     ] 2023-08-23 09:09:09,985 Computing gravitational potential of ClusterModel object; gravity=Newtonian. gravity=Newtonian.
cluster_generator : [INFO     ] 2023-08-23 09:09:09,986 Computation of potential is using mdr for computation.
cluster_generator : [INFO     ] 2023-08-23 09:09:13,832 Integrating pressure profile.
cluster_generator : [INFO     ] 2023-08-23 09:09:25,339 ClusterModel [ClusterModel object; gravity=Newtonian] has no virialization method. Setting to default = eddington
</pre></div></div>
</div>
<p>Let’s go through this output because it tells us alot about what’s going on behind the scenes. The first line tells us that we are generated a <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> object from density and total density. There are also other ways to generate galaxy cluster models. For example, <code class="docutils literal notranslate"><span class="pre">cg.model.ClusterModel.from_dens_and_temp</span></code> and <code class="docutils literal notranslate"><span class="pre">cg.model.ClusterModel.from_dens_and_entr</span></code> both allow the user to generate <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> objects from temperature and entropy profiles respectively. The next 5 lines of the
output are all about filling in the blanks where we need to compute fields not explicitly provided by the user. In this specific case, the backend is integrating to determine masses, and then passing to the Poisson solver to determine the potential.</p>
<p>The final line of the output is more interesting. Every <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> object has a <code class="docutils literal notranslate"><span class="pre">ClusterModel.virialization_method</span></code> which determines how <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code> computes the velocity distribution of halo particles. We’ll talk more about this later. For now, let’s look at what comes out on the other side of the construction process!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dens_tden_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ClusterModel object; gravity=Newtonian, fields=[&#39;radius&#39;, &#39;density&#39;, &#39;total_density&#39;, &#39;total_mass&#39;, &#39;gas_mass&#39;, &#39;stellar_density&#39;, &#39;gravitational_potential&#39;, &#39;gravitational_field&#39;, &#39;pressure&#39;, &#39;temperature&#39;, &#39;dark_matter_density&#39;, &#39;dark_matter_mass&#39;, &#39;gas_fraction&#39;, &#39;electron_number_density&#39;, &#39;entropy&#39;]
</pre></div></div>
</div>
<p>That’s a lot of fields! To access any of the data, you can either use <code class="docutils literal notranslate"><span class="pre">dens_tden_model[&quot;field-name&quot;]</span></code> or <code class="docutils literal notranslate"><span class="pre">dens_tden_model.fields[&quot;field-name&quot;]</span></code>. Let’s try plotting some of the data!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pull out the data #</span>
<span class="n">rr</span> <span class="o">=</span> <span class="n">dens_tden_model</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">dens_tden_model</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
<span class="n">pot</span> <span class="o">=</span> <span class="n">dens_tden_model</span><span class="p">[</span><span class="s2">&quot;gravitational_potential&quot;</span><span class="p">]</span>
<span class="c1"># plotting #</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">rr</span><span class="o">.</span><span class="n">d</span><span class="p">,</span><span class="n">temp</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radius / </span><span class="si">{</span><span class="n">rr</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Temperature / </span><span class="si">{</span><span class="n">temp</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">rr</span><span class="o">.</span><span class="n">d</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pot</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radius / </span><span class="si">{</span><span class="n">rr</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Potential / </span><span class="si">{</span><span class="n">pot</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quick_notebooks_book_2_7_0.png" src="../_images/quick_notebooks_book_2_7_0.png" />
</div>
</div>
<section id="Checking-Out-the-Cluster">
<h2>Checking Out the Cluster<a class="headerlink" href="#Checking-Out-the-Cluster" title="Permalink to this heading">#</a></h2>
<p>Okay, so we have a galaxy cluster but we probably want to make sure it’s behaving well before moving on. There are two methods for checking on <code class="docutils literal notranslate"><span class="pre">ClusterModels</span></code>: <code class="docutils literal notranslate"><span class="pre">.is_physical</span></code> and <code class="docutils literal notranslate"><span class="pre">.check_hse</span></code>. The <code class="docutils literal notranslate"><span class="pre">.is_physical</span></code> method checks that none of the density profiles or temperature profiles becomes non-physical. The <code class="docutils literal notranslate"><span class="pre">.check_hse()</span></code> method checks to make sure that the galaxy cluster remains in hydrostatic equilibrium. Let’s try them out:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_phys</span> <span class="o">=</span> <span class="n">dens_tden_model</span><span class="o">.</span><span class="n">is_physical</span><span class="p">()</span>
<span class="n">check_hse</span> <span class="o">=</span> <span class="n">dens_tden_model</span><span class="o">.</span><span class="n">check_hse</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
✔ cluster_generator : [INFO     ] Wed Aug 23 09:10:04 2023 Checking physicality ⠙ luster_generator : [INFO     ] Wed Aug 23 09:10:04 2023 Checking physicality o ClusterModel object; gravity=Newtonian is physical.
cluster_generator : [INFO     ] 2023-08-23 09:10:04,795 The maximum relative deviation of this profile from hydrostatic equilibrium is 1.76071e-06

</pre></div></div>
</div>
<p>Awesome, our entire cluster makes logical sense! Now, let’s move onto some more advanced aspects of the model.</p>
</section>
<section id="Virializing-Your-Cluster">
<h2>Virializing Your Cluster<a class="headerlink" href="#Virializing-Your-Cluster" title="Permalink to this heading">#</a></h2>
<p>Okay, so you’ve got a <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> generated and now you want to figure out the halo particle’s velocity distribution so that you can initialize them in an N-body code? <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code> makes the process really simple. The first step is to choose how we want to virialize the cluster. There are two options: Eddington’s Formula or the Local Maxwellian Approximation. In this case, we can check out both, but the user should do some reading to figure out which best suits their needs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># virializing #</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The virialization method is: </span><span class="si">{</span><span class="n">dens_tden_model</span><span class="o">.</span><span class="n">virialization_method</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

<span class="n">vir</span> <span class="o">=</span> <span class="n">dens_tden_model</span><span class="o">.</span><span class="n">dm_virial</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The virialization method is: eddington.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0daed697aa8d469e879b635f4237e6c0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>Okay, so what’s happened here? We figured out that our <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code> is using <code class="docutils literal notranslate"><span class="pre">eddington</span></code> as the virialization method. It turns out that <code class="docutils literal notranslate"><span class="pre">cluster_generator</span></code> figures this out automatically depending on what <code class="docutils literal notranslate"><span class="pre">gravity</span></code> you select for the <code class="docutils literal notranslate"><span class="pre">ClusterModel</span></code>. You can always change it afterwards. Now, the <code class="docutils literal notranslate"><span class="pre">vir</span></code> object is a new class: the <code class="docutils literal notranslate"><span class="pre">VirialEquilibrium</span></code> class. The user almost never needs to actually interact with this class, but it’s constructed to house all of the machinery for solving
the virialization problem. What is useful is that now we can access the distribution function (see Binney / Tremaine) of our cluster:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dens_tden_model</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">d</span><span class="p">,</span><span class="n">vir</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quick_notebooks_book_2_13_0.png" src="../_images/quick_notebooks_book_2_13_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>We can also check that the <code class="docutils literal notranslate"><span class="pre">VirialEquilibrium</span></code> object is correct by calling</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span><span class="p">,</span><span class="n">check</span> <span class="o">=</span> <span class="n">dens_tden_model</span><span class="o">.</span><span class="n">check_dm_virial</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dens_tden_model</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">d</span><span class="p">,</span><span class="n">dens_tden_model</span><span class="p">[</span><span class="s2">&quot;total_density&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dens_tden_model</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">d</span><span class="p">,</span><span class="n">rho</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
cluster_generator : [INFO     ] 2023-08-23 09:25:30,224 The maximum relative deviation of this profile from virial equilibrium is 17.3225
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quick_notebooks_book_2_15_1.png" src="../_images/quick_notebooks_book_2_15_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
</section>
<section id="Generating-Particles">
<h2>Generating Particles<a class="headerlink" href="#Generating-Particles" title="Permalink to this heading">#</a></h2>
</section>
<section id="Saving-Models-to-Disk">
<h2>Saving Models to Disk<a class="headerlink" href="#Saving-Models-to-Disk" title="Permalink to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="book_1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Using Radial Profiles</p>
      </div>
    </a>
    <a class="right-next"
       href="book_3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">&lt;no title&gt;</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Checking-Out-the-Cluster">Checking Out the Cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Virializing-Your-Cluster">Virializing Your Cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Generating-Particles">Generating Particles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Saving-Models-to-Disk">Saving Models to Disk</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/quick_notebooks/book_2.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2020, John ZuHone.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>